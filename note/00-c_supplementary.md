# c supplemetary content

è‡ªç”¨è¡¥å……

* [c supplemetary content](#c-supplemetary-content)
  * [å­˜å‚¨ç±»](#å­˜å‚¨ç±»)
    * [auto](#auto)
    * [register](#register)
    * [static](#static)
    * [extern](#extern)
  * [enumerative](#enumerative)
    * [æšä¸¾å˜é‡å®šä¹‰](#æšä¸¾å˜é‡å®šä¹‰)
    * [éå†](#éå†)
  * [å‡½æ•°æŒ‡é’ˆ](#å‡½æ•°æŒ‡é’ˆ)
    * [å›è°ƒå‡½æ•°](#å›è°ƒå‡½æ•°)
  * [struct](#struct)
    * [struct pointer](#struct-pointer)
  * [ä½åŸŸ](#ä½åŸŸ)
    * [å®šä¹‰](#å®šä¹‰)
    * [æ— åä½åŸŸ](#æ— åä½åŸŸ)
    * [ä¸ºä»€ä¹ˆä½¿ç”¨ä½åŸŸ](#ä¸ºä»€ä¹ˆä½¿ç”¨ä½åŸŸ)
  * [å…±ç”¨ä½“ï¼šunion](#å…±ç”¨ä½“union)
  * [typedef](#typedef)
    * [typedef vs #define](#typedef-vs-define)
  * [è¾“å…¥ & è¾“å‡º](#è¾“å…¥--è¾“å‡º)
    * [getchar() & putchar()](#getchar--putchar)
    * [gets() & puts()](#gets--puts)
    * [scanf & printf](#scanf--printf)
  * [File I/O](#file-io)
    * [äºŒè¿›åˆ¶I/O](#äºŒè¿›åˆ¶io)
  * [Cé¢„å¤„ç†å™¨](#cé¢„å¤„ç†å™¨)
    * [é¢„å®šä¹‰å®](#é¢„å®šä¹‰å®)
    * [é¢„å¤„ç†å™¨è¿ç®—ç¬¦](#é¢„å¤„ç†å™¨è¿ç®—ç¬¦)
      * [å®å»¶ç»­è¿ç®—ç¬¦: \](#å®å»¶ç»­è¿ç®—ç¬¦-)
      * [å­—ç¬¦ä¸²å¸¸é‡åŒ–è¿ç®—ç¬¦:](#å­—ç¬¦ä¸²å¸¸é‡åŒ–è¿ç®—ç¬¦)
      * [æ ‡è®°ç²˜è´´è¿ç®—ç¬¦:](#æ ‡è®°ç²˜è´´è¿ç®—ç¬¦)
      * [defined() è¿ç®—ç¬¦](#defined-è¿ç®—ç¬¦)
    * [å‚æ•°åŒ–å®](#å‚æ•°åŒ–å®)
  * [å¤´æ–‡ä»¶](#å¤´æ–‡ä»¶)
    * [åªå¼•ç”¨ä¸€æ¬¡å¤´æ–‡ä»¶](#åªå¼•ç”¨ä¸€æ¬¡å¤´æ–‡ä»¶)
    * [æœ‰æ¡ä»¶å¼•ç”¨](#æœ‰æ¡ä»¶å¼•ç”¨)
  * [å¼ºåˆ¶ç±»å‹è½¬æ¢](#å¼ºåˆ¶ç±»å‹è½¬æ¢)
    * [æ•´æ•°æå‡](#æ•´æ•°æå‡)
    * [å¸¸ç”¨ç®—æœ¯è½¬æ¢](#å¸¸ç”¨ç®—æœ¯è½¬æ¢)
  * [cé”™è¯¯å¤„ç†](#cé”™è¯¯å¤„ç†)
    * [ç¨‹åºé€€å‡ºçŠ¶æ€](#ç¨‹åºé€€å‡ºçŠ¶æ€)
  * [å¯å˜å‚æ•°](#å¯å˜å‚æ•°)
  * [åŠ¨æ€å†…å­˜ç®¡ç†](#åŠ¨æ€å†…å­˜ç®¡ç†)
    * [åŠ¨æ€åˆ†é…å†…å­˜](#åŠ¨æ€åˆ†é…å†…å­˜)
    * [é‡æ–°è°ƒæ•´å†…å­˜å¤§å° & é‡Šæ”¾å†…å­˜](#é‡æ–°è°ƒæ•´å†…å­˜å¤§å°--é‡Šæ”¾å†…å­˜)
  * [å‘½ä»¤è¡Œå‚æ•°](#å‘½ä»¤è¡Œå‚æ•°)

## å­˜å‚¨ç±»

å®šä¹‰cç¨‹åºä¸­**å˜é‡/å‡½æ•°**

* å¯è§æ€§
* ç”Ÿå‘½å‘¨æœŸ

å¯ç”¨å­˜å‚¨ç±»

* `auto`
* `register`
* `static`
* `extern`

### auto

`auto`å­˜å‚¨ç±»

* æ‰€æœ‰å±€éƒ¨å˜é‡é»˜è®¤å­˜å‚¨ç±»

```c
{
    //auto åªèƒ½ç”¨äºå‡½æ•°å†…ï¼Œä¿®é¥°å±€éƒ¨å˜é‡
    int mount;
    auto int month;
}
```

### register

`resiter`å­˜å‚¨ç±»

* ç”¨äºå®šä¹‰å­˜å‚¨åœ¨**å¯„å­˜å™¨ä¸­ï¼ˆè€Œä¸æ˜¯ramï¼‰çš„å±€éƒ¨å˜é‡**
* <font color="red">å®šä¹‰çš„å˜é‡æœ€å¤§å¤§å°åŒ¹é…å¯„å­˜å™¨å¤§å°ï¼Œä¸èƒ½å¯¹å…¶åº”ç”¨`&`è¿ç®—ç¬¦</font>

```c
{
    // ç”¨äºå¿«é€Ÿè®¿é—®çš„å˜é‡ï¼Œå¦‚è®¡æ•°å™¨
    // registerå¹¶ä¸æ„å‘³ç€å˜é‡ä¸€å®šå­˜å‚¨åœ¨å¯„å­˜å™¨ï¼Œå–å†³äºç¡¬ä»¶&å®ç°çš„é™åˆ¶
    register int miles;
}
```

### static

`static`å­˜å‚¨ç±»

* æŒ‡ç¤ºï¼Œç¼–è¯‘å™¨åœ¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå†…**ä¿æŒå±€éƒ¨å˜é‡çš„å­˜åœ¨ï¼Œè€Œä¸éœ€è¦æ¯æ¬¡è¿›è¡Œåˆ›å»º&é”€æ¯**
* **å¯åº”ç”¨äºå…¨å±€å˜é‡**
  * ä½¿å…¶ä½œç”¨åŸŸé™åˆ¶åœ¨å£°æ˜ä»–çš„æ–‡ä»¶å†…

```c
#include<stdio.h>

void func1(void);//prototype

static int count=10;//å…¨å±€å˜é‡

int main(){
    while(count--){
        func1();
    }
    return 0;
}

void func1(void){
    static int thingy=5;
    thingy++ï¼›
    printf("thingyä¸º%d, countä¸º%d", thingy, count);
}
```

### extern

`extern`å­˜å‚¨ç±»

* æä¾›ä¸€ä¸ªå…¨å±€å˜é‡çš„å¼•ç”¨ï¼Œ**åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­å£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡orå‡½æ•°**
  * å¯¹æ‰€æœ‰ç¨‹åºæ–‡ä»¶å¯è§
  * **é€šå¸¸ç”¨äºæœ‰ä¸¤ä¸ªorå¤šä¸ªæ–‡ä»¶å…±äº«ç›¸åŒå…¨å±€å˜é‡orå‡½æ•°æ—¶**
* <font color="red">å¯¹äºæ— æ³•åˆå§‹åŒ–çš„å˜é‡ï¼Œä¼šæŠŠå˜é‡åæŒ‡å‘ä¸€ä¸ªä¹‹å‰å®šä¹‰è¿‡çš„å­˜å‚¨ä½ç½®</font>
* <font color="blue">å½“æœ‰å¤šä¸ªæ–‡ä»¶ï¼Œä¸”å®šä¹‰äº†ä¸€ä¸ªå¯ä»¥åœ¨å…¶ä»–æ–‡ä»¶ä¸­ä½¿ç”¨çš„å…¨å±€å˜é‡orå‡½æ•°æ—¶</font>
  * å¯ä»¥åœ¨å…¶ä»–æ–‡ä»¶ä¸­ä½¿ç”¨`extern`æ¥å¾—åˆ°å·²ç»å®šä¹‰çš„å˜é‡orå‡½æ•°çš„å¼•ç”¨

```c
// main.c
#include<stdio.h>

int count;
extern void write_extern();//å¼•ç”¨

int main(){
    count=5;
    write_extern();
}
```

```c
// support.c
#include<stdio.h>

extern int count;//å¼•ç”¨å…¨å±€å˜é‡

void write_extern(void)
{
    printf("count is %d", count);
}
```

ç¼–è¯‘ `gcc main.c support.c -o a.out`

## enumerative

æšä¸¾

* `enum type_name{element1, element2,...}`
* cä¸­è¢«å½“ä½œ`int`æˆ–`unsigned int`å¤„ç†

```c
// ä¸ä½¿ç”¨æšä¸¾,ä¸æ•´æ´ï¼Œä»£ç é‡å¤š
#define MON 1
#define TUE 2
#define WED 3
#define THU 4
#define FRI 5
#define SAT 6
#define SUN 7

// æ”¹è¿›, ç¬¬ä¸€ä¸ªæšä¸¾æˆå‘˜é»˜è®¤å€¼ä¸º0ï¼Œå¯è°ƒ
enum DAY
{
    MON=1,TUE,WED,THU,FRI,SAT,SUN
};

enum season{
    // spring=0, summer=3, autumn=4,...
    spring, summer=3, autumn, winter
};
```

### æšä¸¾å˜é‡å®šä¹‰

```c
// 1. å®šä¹‰æšä¸¾ç±»å‹ï¼Œåœ¨å®šä¹‰å˜é‡
enum DAY{
    MON=1, TUE,WED,THU,FRI,SAT, SUN
}

enum DAY day;

// 2.åŒæ—¶å®šä¹‰
enum DAY{
    MON=1, TUE,WED,THU,FRI,SAT, SUN
} day;

// 3.çœç•¥æšä¸¾åç§°(æ— åæšä¸¾)ï¼Œç›´æ¥å®šä¹‰æšä¸¾å˜é‡
enum{
    MON=1, TUE,WED,THU,FRI,SAT, SUN
} day;
```

### éå†

ä¸è¿ç»­çš„æšä¸¾ç±»å‹æ— æ³•éå†
![](/static/2020-10-23-22-21-05.png)

```c
enum{
    MON=1, TUE,WED,THU,FRI,SAT, SUN
} day;

int main(){
    for(day=MON; day<=SUN; day++){
        print("enum: %d", day);
    }
}
```

## å‡½æ•°æŒ‡é’ˆ

å‡½æ•°æŒ‡é’ˆ

* æŒ‡å‘å‡½æ•°
* **å¯ä»¥åƒä¸€èˆ¬å‡½æ•°ä¸€æ ·ï¼Œç”¨äºè°ƒç”¨å‡½æ•°ï¼Œä¼ é€’å‚æ•°**
* `typedef int (*fun_ptr)(int,int);`ç”Ÿæˆä¸€ä¸ªæŒ‡å‘åŒæ ·å‚æ•°ï¼Œè¿”å›å€¼çš„å‡½æ•°æŒ‡é’ˆç±»å‹

```c
int max(int x,int y){
    return x> y?x :y;
}

int main(void){
    int (*p)(int,int) = & max;// &å¯çœç•¥ï¼Œå‡½æ•°maxæŒ‡é’ˆ
    int a,b,c,d;
    scanf("%d %d %d", &a,&b,&c);

    // è°ƒç”¨ï¼Œç­‰åŒäº d = max(max(a,b), c)
    d = p(p(a,b), c);
    return 0;
}
```

### å›è°ƒå‡½æ•°

å‡½æ•°æŒ‡é’ˆä½œä¸ºå‡½æ•°å‚æ•°

* å›è°ƒå‡½æ•° - é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨çš„å‡½æ•°
  * **åˆ«çš„å‡½æ•°æ‰§è¡Œæ—¶ï¼Œé€šè¿‡å‡½æ•°æŒ‡é’ˆï¼Œè°ƒç”¨ä½ å®ç°çš„å‡½æ•°**

```c
//å›è°ƒå‡½æ•°
void populate_array(int* array, size_t arraySize, int(*getValue)(void))
{
    for (size_t i=0; i<arraySize; i++>)
    {
        array[i] = getValue();//å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°
    }
}

int getNextRandomValue(void)
{
    return rand();
}

int main(){
    int array[10];
    populate_array(array, 10, getNextRandomValue);// &å‡½æ•°åï¼Œ&å¯çœ
    return 0;
}
```

## struct

äº’ç›¸åŒ…å«çš„ç»“æ„ä½“
![](/static/2020-10-23-23-50-27.png)

### struct pointer

![](/static/2020-10-23-23-51-46.png)

## ä½åŸŸ

> **æœ‰äº›ä¿¡æ¯å­˜å‚¨æ—¶ï¼Œå¹¶ä¸éœ€è¦å ç”¨ä¸€ä¸ªå®Œæ•´çš„å­—èŠ‚ï¼Œè€Œåªéœ€å å‡ ä¸ªæˆ–ä¸€ä¸ªäºŒè¿›åˆ¶ä½**
>
> ä¾‹å¦‚åœ¨å­˜æ”¾ä¸€ä¸ªå¼€å…³é‡æ—¶ï¼Œåªæœ‰ 0 å’Œ 1 ä¸¤ç§çŠ¶æ€ï¼Œç”¨ 1 ä½äºŒè¿›ä½å³å¯
>
> ä¸ºäº†èŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œå¹¶ä½¿å¤„ç†ç®€ä¾¿ï¼ŒC è¯­è¨€åˆæä¾›äº†ä¸€ç§æ•°æ®ç»“æ„ï¼Œç§°ä¸º"ä½åŸŸ"æˆ–"ä½æ®µ"ã€‚

* "ä½åŸŸ"
  * æŠŠä¸€ä¸ªå­—èŠ‚ä¸­çš„äºŒè¿›ä½åˆ’åˆ†ä¸ºå‡ ä¸ªä¸åŒçš„åŒºåŸŸï¼Œå¹¶è¯´æ˜æ¯ä¸ªåŒºåŸŸçš„ä½æ•°ã€‚æ¯ä¸ªåŸŸæœ‰ä¸€ä¸ªåŸŸåï¼Œå…è®¸åœ¨ç¨‹åºä¸­æŒ‰åŸŸåè¿›è¡Œæ“ä½œ
  * è¿™æ ·å°±å¯ä»¥æŠŠå‡ ä¸ªä¸åŒçš„å¯¹è±¡ç”¨ä¸€ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶ä½åŸŸæ¥è¡¨ç¤º
* å®ä¾‹
  * ç”¨ 1 ä½äºŒè¿›ä½å­˜æ”¾ä¸€ä¸ªå¼€å…³é‡æ—¶ï¼Œåªæœ‰ 0 å’Œ 1 ä¸¤ç§çŠ¶æ€ã€‚
  * è¯»å–å¤–éƒ¨æ–‡ä»¶æ ¼å¼â€”â€”å¯ä»¥è¯»å–éæ ‡å‡†çš„æ–‡ä»¶æ ¼å¼ã€‚ä¾‹å¦‚ï¼š9 ä½çš„æ•´æ•°
* **ä½åŸŸåœ¨æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§ç»“æ„ä½“ç±»å‹ï¼Œä¸è¿‡å…¶æˆå‘˜æ˜¯æŒ‰äºŒè¿›ä½åˆ†é…çš„ã€‚**

### å®šä¹‰

```c
struct ä½åŸŸç»“æ„å{
  // ä½åŸŸåˆ—è¡¨: type bit_field_name: length
};
```

ğŸŠ ä¾‹å­

```c
struct bs{
    //å…±å 2B
    int a:8; // ä½åŸŸaå 8bit
    int b:2; // ä½åŸŸbå 2bit
    int c:6;
}data;
```

### æ— åä½åŸŸ

![](/static/2020-10-24-00-00-49.png)

### ä¸ºä»€ä¹ˆä½¿ç”¨ä½åŸŸ

![](/static/2020-10-24-00-17-40.png)

## å…±ç”¨ä½“ï¼šunion

å…±ç”¨ä½“

* **å…è®¸åœ¨ç›¸åŒå†…å­˜ä½ç½®å­˜å‚¨ä¸åŒæ•°æ®ç±»å‹**
* **æ”¯æŒå¤šæˆå‘˜çš„å…±åŒä½“**

```c
union [union tag] //tagå¯é€‰
{
    member definition;
    member definition;
    ...
    member definition;
}[one or more union variables];//å…±åŒä½“å˜é‡å¯é€‰
```

![](/static/2020-10-24-00-14-44.png)

```c
// Dataå…±åŒä½“ç±»å‹çš„å˜é‡(data),å¯ä»¥å­˜å‚¨: 1ä¸ªæ•´æ•°,1ä¸ªæµ®ç‚¹æ•°,1ä¸ªå­—ç¬¦ä¸²
// Dataå 20B(æœ€å¤§)
union Data{
    int i;
    float f;
    char str[20];//20B
} data;
```

## typedef

`typedef`

* ç”¨äºä¸ºç±»å‹å–æ–°åå­—

```c
typedef unsigned char BYTE;

BYTE b1,b2;// BYTEå¯ä½œä¸º unsigned charçš„ç¼©å†™

typedef struct Books{
    char title[50];
} Book; // Bookå¯ä½œä¸º struct Booksç»“æ„ä½“ç±»å‹çš„ç¼©å†™

Book book;
book.title;
```

### typedef vs #define

åŒºåˆ«

* `typedef`
  * ç”¨äºä¸º**ç±»å‹å®šä¹‰ç¬¦å·åç§°**
  * **ç”±ç¼–è¯‘å™¨æ‰§è¡Œè§£é‡Š**
* `#define`
  * å¯ä¸º**ç±»å‹/æ•°å€¼å®šä¹‰åˆ«å**
    * å¦‚`#defin one 1`
  * **ç”±é¢„å¤„ç†å™¨å¤„ç†**

![](/static/2020-10-24-00-24-03.png)

## è¾“å…¥ & è¾“å‡º

æ ‡å‡†è¾“å…¥

* æ–‡ä»¶æŒ‡é’ˆ`stdin`
* é”®ç›˜

æ ‡å‡†è¾“å‡º

* æ–‡ä»¶æŒ‡é’ˆ`stdout`
* å±å¹•

æ ‡å‡†é”™è¯¯

* æ–‡ä»¶æŒ‡é’ˆ`stderr`
* å±å¹•

### getchar() & putchar()

![](/static/2020-10-24-00-36-14.png)

`int getchar(void)`

* è¯»å–char,è¿”å›ä¸ºint
* å¯å¾ªç¯è¯»å–å¤šä¸ªchar

`int putchar(int c)`

* æŒ‰charè¾“å‡ºåˆ°å±å¹•,è¿”å›ç›¸åŒå­—ç¬¦
* å¯ä»¥å¾ªç¯è¾“å‡ºå¤šä¸ªchar

### gets() & puts()

![](/static/2020-10-24-00-39-46.png)

`char* gets(char* s)`

* ä»`stdin`è¯»å–**ä¸€è¡Œ**,åˆ°`s`æ‰€æŒ‡ç¼“å†²åŒº
  * **ç›´åˆ°ç»ˆæ­¢ç¬¦ or `EOF`**

`ins puts(const char *s)`

* æŠŠså’Œå…¶`\n`å†™å…¥`stdout`

### scanf & printf

![](/static/2020-10-24-00-41-27.png)

## File I/O

æ‰“å¼€æ–‡ä»¶

* `FILE *fopen( const char * filename, const char * mode );`
  * `filename`å­—ç¬¦ä¸²
  * `mode`å¯ä¸º
    * ![1](/static/2020-10-24-00-55-06.png)

å…³é—­æ–‡ä»¶

* `int fclose(FILE *fp);`
  * `0` - æˆåŠŸå…³é—­
  * `EOF` - å…³é—­å¼‚å¸¸
* å®è´¨: æ¸…ç©ºç¼“å†²åŒºä¸­æ•°æ®,å…³é—­æ–‡ä»¶,é‡Šæ”¾å†…å­˜

å†™å…¥æ–‡ä»¶

* `int fputc(int c,FILE* fp)` å•å­—ç¬¦
  * `fputc()`æŠŠå‚æ•°cçš„å­—ç¬¦å€¼å†™å…¥åˆ°fpæ‰€æŒ‡å‘çš„è¾“å‡ºæµ(æ–‡ä»¶)
  * æˆåŠŸ - è¿”å›å†™å…¥å­—ç¬¦
  * å¤±è´¥ - `EOF`
* `int fputs(const char *s, FILE* fp);` å­—ç¬¦ä¸²(å¤šå­—ç¬¦ç¼“å†²)
  * æŠŠä¸€ä¸ªä»¥ null ç»“å°¾çš„**å­—ç¬¦ä¸²å†™å…¥åˆ°æµ**ä¸­
  * æˆåŠŸ - è¿”å›éè´Ÿint
  * å¤±è´¥ - `EOF`
* `int fprintf(FILE *fp,const char *format, ...)` å­—ç¬¦ä¸²è¾“å‡ºè‡³æ–‡ä»¶è¾“å‡ºæµ

è¯»å–æ–‡ä»¶

* `int fgetc(FILE* fp)` å•å­—ç¬¦æ–‡ä»¶è¾“å…¥æµ
  * æˆåŠŸ - è¿”å›æ‰€è¯»å­—ç¬¦
  * å¤±è´¥ - `EOF`
* `char* fgets(char* buf, int n, FILE *fp)`å¤šå­—ç¬¦(å­—ç¬¦ä¸²)æ–‡ä»¶ç¼“å†²è¾“å…¥æµ
  * å‡½æ•° fgets() ä» fp æ‰€æŒ‡å‘çš„è¾“å…¥æµä¸­è¯»å– n - 1 ä¸ªå­—ç¬¦
  * **è¯»å–çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ°ç¼“å†²åŒº `buf`**ï¼Œå¹¶åœ¨æœ€åè¿½åŠ ä¸€ä¸ª null å­—ç¬¦æ¥ç»ˆæ­¢å­—ç¬¦ä¸²
  * **é‡åˆ°`\n`æˆ–`EOF`ç»“æŸ**
* `int fscanf(FILE *fp, const char *format, ...)`
  * ä»æ–‡ä»¶ä¸­è¯»å–å­—ç¬¦ä¸², å¤šå­—ç¬¦æ–‡ä»¶ç¼“å†²è¾“å…¥æµ(æ–‡ä»¶->å†…å­˜)
  * åœ¨é‡åˆ°**ç¬¬ä¸€ä¸ªç©ºæ ¼å’Œæ¢è¡Œç¬¦ç»“æŸ**

ğŸŠ ä¾‹å­

```c
int main()
{
    //å†™
    FILE* fp = NULL;
    fp = fopen("/tmp/test.txt", "w+");
    fprintf(fp, "Testing for fprintf...\n");
    fputs("hahahah", fp);
    fclose(fp);

    // è¯»
    FILE* fp = NULL;
    char buff[255];
    fp = fopen("...", "r");
    fgetc(fp);
    fgets(buff, 255, fp);
    fscanf(fp, "%s", buff);
}
```

### äºŒè¿›åˆ¶I/O

![](/static/2020-10-24-01-15-40.png)

## Cé¢„å¤„ç†å™¨

æ–‡æœ¬æ›¿æ¢å·¥å…·

![](/static/2020-10-24-15-43-40.png)

* åœ¨å®é™…ç¼–è¯‘ä¹‹å‰å®Œæˆæ‰€éœ€é¢„å¤„ç†
* C preprocessor - CPP
* æ‰€æœ‰é¢„å¤„ç†å‘½ä»¤,ä»¥`#`å¼€å¤´

ğŸŠ ä¾‹å­

```c
// å‘Šè¯‰ CPP æŠŠæ‰€æœ‰çš„ MAX_ARRAY_LENGTH æ›¿æ¢ä¸º 20ã€‚ä½¿ç”¨ #define å®šä¹‰å¸¸é‡æ¥å¢å¼ºå¯è¯»æ€§
#defin MAX_ARRAY_LENGTH 20
```

```c
// è¿™ä¸ªæŒ‡ä»¤å‘Šè¯‰ CPP å–æ¶ˆå·²å®šä¹‰çš„ FILE_SIZEï¼Œå¹¶å®šä¹‰å®ƒä¸º 42
#undef  FILE_SIZE
#define FILE_SIZE 42
```

```c
// è¿™ä¸ªæŒ‡ä»¤å‘Šè¯‰ CPP åªæœ‰å½“ MESSAGE æœªå®šä¹‰æ—¶ï¼Œæ‰å®šä¹‰ MESSAGE
#ifndef MESSAGE
   #define MESSAGE "You wish!"
#endif
```

```c
// è¿™ä¸ªæŒ‡ä»¤å‘Šè¯‰ CPP å¦‚æœå®šä¹‰äº† DEBUGï¼Œåˆ™æ‰§è¡Œå¤„ç†è¯­å¥ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œå¦‚æœæ‚¨å‘ gcc ç¼–è¯‘å™¨ä¼ é€’äº† -DDEBUG å¼€å…³é‡ï¼Œè¿™ä¸ªæŒ‡ä»¤å°±éå¸¸æœ‰ç”¨ã€‚å®ƒå®šä¹‰äº† DEBUGï¼Œæ‚¨å¯ä»¥åœ¨ç¼–è¯‘æœŸé—´éšæ—¶å¼€å¯æˆ–å…³é—­è°ƒè¯•
#ifdef DEBUG
   /* Your debugging statements here */
#endif
```

### é¢„å®šä¹‰å®

![](/static/2020-10-24-15-49-07.png)
![](/static/2020-10-24-15-49-37.png)

### é¢„å¤„ç†å™¨è¿ç®—ç¬¦

#### å®å»¶ç»­è¿ç®—ç¬¦: \

* `\`
* å•è¡Œæœªå®Œæˆå®å®šä¹‰æ—¶ä½¿ç”¨

```c
#define message_for(a, b) \
    printf(#a "and" #b ": hahh\n")
```

#### å­—ç¬¦ä¸²å¸¸é‡åŒ–è¿ç®—ç¬¦: #

* `#`
* å½“éœ€è¦**æŠŠä¸€ä¸ªå®çš„å‚æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¸¸é‡**æ—¶
  * æœ‰ç‰¹å®šå‚æ•°/å‚æ•°åˆ—è¡¨

```c
#define message_for(a,b) \
    printf(#a "and" #b ": hahh\n")

//ä¼šå°†ä¼ å…¥çš„å‚æ•°,è½¬å…¥å­—ç¬¦ä¸²å¸¸é‡
int main(void)
{
    message_for(a, b);
    return 0;
}
```

#### æ ‡è®°ç²˜è´´è¿ç®—ç¬¦: ##

* `##`
* åˆå¹¶ä¸¤ä¸ªå‚æ•°
  * å…è®¸åœ¨å®å®šä¹‰ä¸­ä¸¤ä¸ªç‹¬ç«‹æ ‡è®°åˆå¹¶ä¸ºä¸€ä¸ª

```c
#define tokenpaster(n) printf ("token" #n " = %d", token##n)

//printf ("token34 = %d", token34);
int main(void)
{
   int token34 = 40;

   tokenpaster(34);//token34 = 40
   return 0;
}
```

#### defined() è¿ç®—ç¬¦

`defined`é¢„å¤„ç†å™¨

* ç”¨äºå¸¸é‡è¡¨è¾¾å¼,**åˆ¤æ–­ä¸€ä¸ªæ ‡è¯†ç¬¦æ˜¯å¦è¢«`#define`è¿‡**
  * å¦‚ä»¥å®šä¹‰,å€¼ä¸ºçœŸ(éé›¶)
  * æœªå®šä¹‰,å€¼ä¸ºå‡(0)

```c
#if !defined (MESSAGE)
   #define MESSAGE "You wish!"
#endif

int main(void)
{
   printf("Here is the message: %s\n", MESSAGE);  
   return 0;
}
```

### å‚æ•°åŒ–å®

ä½¿ç”¨å‚æ•°åŒ–çš„å®, **æ¨¡æ‹Ÿå‡½æ•°**

* æ³¨æ„`()`

```c
int square(int x) {
   return x * x;
}

// å¯å†™ä¸ºå®
#define sqaure(x) ((x) * (x))

#define MAX(x,y) ((x) > (y) ? (x) : (y))

int main(void)
{
   printf("Max between 20 and 10 is %d\n", MAX(10, 20));  
   return 0;
}
```

## å¤´æ–‡ä»¶

æ‰©å±•åä¸º`.h`çš„æ–‡ä»¶

* åŒ…å«äº†**cå‡½æ•°å£°æ˜ & å®å®šä¹‰**
  * è¢«å¤šä¸ªæºæ–‡ä»¶ä¸­å¼•ç”¨å…±äº«
* åˆ†ç±»
  * **è‡ªå®šä¹‰å¤´æ–‡ä»¶**
  * **ç¼–è¯‘å™¨è‡ªå¸¦å¤´æ–‡ä»¶**
* ä½¿ç”¨
  * `#include`é¢„å¤„ç†æŒ‡ä»¤å¼•ç”¨å¤´æ–‡ä»¶,**ç›¸å½“äºå¤åˆ¶å¤´æ–‡ä»¶å†…å®¹**

### åªå¼•ç”¨ä¸€æ¬¡å¤´æ–‡ä»¶

å¦‚æœä¸€ä¸ªå¤´æ–‡ä»¶è¢«å¼•ç”¨ä¸¤æ¬¡ï¼Œç¼–è¯‘å™¨ä¼šå¤„ç†ä¸¤æ¬¡å¤´æ–‡ä»¶çš„å†…å®¹ï¼Œè¿™å°†äº§ç”Ÿé”™è¯¯

* **ä½¿ç”¨æ¡ä»¶ç¼–è¯‘è¯­å¥**
* **åŒ…è£…å™¨ #ifndef**
  * å†æ¬¡å¼•ç”¨å¤´æ–‡ä»¶,æ¡ä»¶ä¸ºå‡,å› ä¸ºå·²å®šä¹‰.æ­¤æ—¶é¢„å¤„ç†å™¨ä¼šè·³è¿‡è¯¥æ–‡ä»¶çš„æ•´ä¸ªå†…å®¹,ç¼–è¯‘å™¨ä¼šå¿½ç•¥ä»–

ğŸŠ æ ‡è¯†å‘½å

* åº”å”¯ä¸€,ä¸€èˆ¬å¤´æ–‡ä»¶åå…¨å¤§å†™,å‰ååŠ ä¸‹åˆ’çº¿,`.`ä¹Ÿå˜ä¸ºä¸‹åˆ’çº¿
  * å¦‚`stdio.h` -> `#ifndef _STDIO_H_`

```c
#ifndef HEADER_FILE
#define HEADER_FILE

the entire header file file

#endif
```

### æœ‰æ¡ä»¶å¼•ç”¨

æœ‰æ—¶éœ€è¦ä»**å¤šä¸ªä¸åŒçš„å¤´æ–‡ä»¶ä¸­é€‰æ‹©ä¸€ä¸ªå¼•ç”¨**åˆ°ç¨‹åºä¸­

* å¦‚æŒ‡å®šåœ¨ä¸åŒosä¸Šä½¿ç”¨é…ç½®å‚æ•°
* **ä½†å¤´æ–‡ä»¶æ¯”è¾ƒå¤šæ—¶,ä¸å¦¥å½“**
  * å¾€å¾€ä¼šç”¨ä¸€ä¸ª`global.h`å¤´æ–‡ä»¶æ¥**åŒ…æ‹¬æ‰€æœ‰è¦å¼•ç”¨çš„`.h`æ–‡ä»¶**
  * **é¢„å¤„ç†å™¨ä½¿ç”¨å®æ¥å®šä¹‰å¤´æ–‡ä»¶åç§° -- æœ‰æ¡ä»¶å¼•ç”¨**

```c
#ifndef _GLOBAL_H
#define _GLOBAL_H
#include <fstream>
#include <iostream>
#include <math.h>
#include <Config.h>
#endif

//å¦å¤–æ–‡ä»¶
#include "global.h"

//2.
#define _GLOBAL_H "global.h"
...
#include _GLOBAL_H
```

```c
#if SYSTEM_1
   # include "system_1.h"
#elif SYSTEM_2
   # include "system_2.h"
#elif SYSTEM_3
   ...
#endif
```

## å¼ºåˆ¶ç±»å‹è½¬æ¢

* `(type) expression`

```c
int main()
{
   int sum = 17, count = 5;
   double mean;

   mean = (double) sum / count;//å¼ºè½¬ä¼˜å…ˆçº§å¤§äºå‡ºå‘
   printf("Value of mean : %f\n", mean );
}
```

### æ•´æ•°æå‡

æŠŠå°äº`int`/`unsigned int`çš„æ•´å‹è½¬ä¸º`int`/`unsigned int`

```c
int  i = 17;
   char c = 'c'; /* ascii å€¼æ˜¯ 99 */
   int sum;

   sum = i + c;//116, 'c'çš„å€¼è¿›è¡Œæ•´æ•°æå‡
   printf("Value of sum : %d\n", sum );
```

### å¸¸ç”¨ç®—æœ¯è½¬æ¢

![](/static/2020-10-24-17-56-43.png)
![](/static/2020-10-24-18-10-50.png)

```c
#include <stdio.h>
/*
c é¦–å…ˆè¢«è½¬æ¢ä¸ºæ•´æ•°ï¼Œä½†æ˜¯ç”±äºæœ€åçš„å€¼æ˜¯ float å‹çš„ï¼Œæ‰€ä»¥ä¼šåº”ç”¨å¸¸ç”¨çš„ç®—æœ¯è½¬æ¢ï¼Œç¼–è¯‘å™¨ä¼šæŠŠ i å’Œ c è½¬æ¢ä¸ºæµ®ç‚¹å‹ï¼Œå¹¶æŠŠå®ƒä»¬ç›¸åŠ å¾—åˆ°ä¸€ä¸ªæµ®ç‚¹æ•°
 */
int main()
{
   int  i = 17;
   char c = 'c'; /* ascii å€¼æ˜¯ 99 */
   float sum;

   sum = i + c;
   printf("Value of sum : %f\n", sum );

}
```

## cé”™è¯¯å¤„ç†

ä¸æä¾›ç›´æ¥çš„é”™è¯¯å¤„ç†

* å‘ç”Ÿé”™è¯¯æ—¶,å¤§å¤šè¿”å›`1/NULL`
  * åŒæ—¶ä¼šè®¾ç½®ä¸€ä¸ª**é”™è¯¯ä»£ç  errno**ï¼Œè¯¥é”™è¯¯ä»£ç æ˜¯å…¨å±€å˜é‡ï¼Œè¡¨ç¤ºåœ¨å‡½æ•°è°ƒç”¨æœŸé—´å‘ç”Ÿäº†é”™è¯¯
  * **å¯ä»¥åœ¨ errno.h å¤´æ–‡ä»¶ä¸­æ‰¾åˆ°å„ç§å„æ ·çš„é”™è¯¯ä»£ç **
* å¯ä»¥é€šè¿‡æ£€æŸ¥è¿”å›å€¼ï¼Œç„¶åæ ¹æ®è¿”å›å€¼å†³å®šé‡‡å–å“ªç§é€‚å½“çš„åŠ¨ä½œ
  * åˆå§‹åŒ–æ—¶ï¼ŒæŠŠ**errno è®¾ç½®ä¸º 0**ï¼Œè¿™æ˜¯ä¸€ç§è‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚0 å€¼è¡¨ç¤ºç¨‹åºä¸­æ²¡æœ‰é”™è¯¯
* <font color="red">åº”è¯¥ä½¿ç”¨ stderr æ–‡ä»¶æµæ¥è¾“å‡ºæ‰€æœ‰çš„é”™è¯¯</font>

![](/static/2020-10-24-18-26-19.png)
![](/static/2020-10-24-18-26-28.png)

### ç¨‹åºé€€å‡ºçŠ¶æ€

![](/static/2020-10-24-18-29-41.png)

## å¯å˜å‚æ•°

å‡½æ•°å¯å˜å‚æ•°

* å¯æ¶‰åŠå®
* `int func(int, ...)`
* **éœ€è¦ä½¿ç”¨ stdarg.h å¤´æ–‡ä»¶**

ğŸŠ å…·ä½“å®ç°

* å®šä¹‰ä¸€ä¸ªå‡½æ•°,å‚æ•°çœç•¥å·
* å‡½æ•°å®šä¹‰å†…åˆ›å»º`va_list`ç±»å‹å˜é‡
  * å¤´æ–‡ä»¶`stdarg.h`ä¸­å®šä¹‰äº†
* ä½¿ç”¨`int`& `va_start`å®
  * **åˆå§‹åŒ–`va_list`ç±»å‹å˜é‡**ä¸ºä¸€ä¸ª**å‚æ•°åˆ—è¡¨**
  * `va_start(valist, num)` numä¸ªå‚æ•°åˆå§‹åŒ–valist
* ä½¿ç”¨**`va_arg`å®**&**`va_list`å˜é‡**è®¿é—®å‚æ•°åˆ—è¡¨ä¸­æ¯ä¸ªé¡¹
  * `va_arg(valist, int)`
* ä½¿ç”¨`va_end`å®
  * æ¸…ç†`va_list`å˜é‡å†…å­˜
  * `va_end(valist)`

```c
#include <stdarg.h>

double average(int num,...)
{

    va_list valist;
    double sum = 0.0;
    int i;
 
    /* ä¸º num ä¸ªå‚æ•°åˆå§‹åŒ– valist */
    va_start(valist, num);
 
    /* è®¿é—®æ‰€æœ‰èµ‹ç»™ valist çš„å‚æ•° */
    for (i = 0; i < num; i++)
    {
       sum += va_arg(valist, int);
    }
    /* æ¸…ç†ä¸º valist ä¿ç•™çš„å†…å­˜ */
    va_end(valist);

    return sum/num;
}

```

## åŠ¨æ€å†…å­˜ç®¡ç†

ğŸ¬ void * ç±»å‹è¡¨ç¤ºæœªç¡®å®šç±»å‹çš„æŒ‡é’ˆã€‚Cã€C++ è§„å®š void * ç±»å‹å¯ä»¥é€šè¿‡ç±»å‹è½¬æ¢å¼ºåˆ¶è½¬æ¢ä¸ºä»»ä½•å…¶å®ƒç±»å‹çš„æŒ‡é’ˆ

`stdlib.h`å¤´æ–‡ä»¶

* `void* calloc(int num, int size)`
  * **å†…å­˜ä¸­åŠ¨æ€åˆ†é…num*sizeä¸ªå­—èŠ‚é•¿åº¦çš„å†…å­˜ç©ºé—´**,ä¸”å­—èŠ‚å€¼éƒ½ä¸º`0`
* `void free(void *address);`
  * æ•°é‡Šæ”¾ address æ‰€æŒ‡å‘çš„å†…å­˜å—,**é‡Šæ”¾çš„æ˜¯åŠ¨æ€åˆ†é…çš„å†…å­˜ç©ºé—´**
* `void *malloc(int num)`
  * **å †åŒºåˆ†é…ä¸€å—æŒ‡å®šå¤§å°çš„å†…å­˜ç©ºé—´ï¼Œç”¨æ¥å­˜æ”¾æ•°æ®**
  * è¿™å—å†…å­˜ç©ºé—´åœ¨å‡½æ•°æ‰§è¡Œå®Œæˆåä¸ä¼šè¢«åˆå§‹åŒ–ï¼Œå®ƒä»¬çš„å€¼æ˜¯æœªçŸ¥çš„
* `void *realloc(void *address, int newsize);`
  * **é‡æ–°åˆ†é…å†…å­˜ï¼ŒæŠŠå†…å­˜æ‰©å±•åˆ° newsize**

### åŠ¨æ€åˆ†é…å†…å­˜

æŒ‰éœ€åˆ†é…

![](/static/2020-10-24-19-25-27.png)

* ä¹Ÿå¯ä»¥ä½¿ç”¨`calloc(200, sizeof(char))`ç¼–å†™

### é‡æ–°è°ƒæ•´å†…å­˜å¤§å° & é‡Šæ”¾å†…å­˜

ç¨‹åºé€€å‡ºæ—¶ï¼Œ**osä¼šè‡ªåŠ¨é‡Šæ”¾æ‰€æœ‰åˆ†é…ç»™ç¨‹åºçš„å†…å­˜**

* <font color="red">åœ¨ä¸éœ€è¦å†…å­˜æ—¶ï¼Œéƒ½åº”è¯¥è°ƒç”¨å‡½æ•° `free()` æ¥é‡Šæ”¾å†…å­˜</font>
* æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨å‡½æ•°**`realloc()`æ¥å¢åŠ æˆ–å‡å°‘å·²åˆ†é…çš„å†…å­˜å—çš„å¤§å°**

![](/static/2020-10-24-19-35-45.png)

## å‘½ä»¤è¡Œå‚æ•°

æ‰§è¡Œç¨‹åºæ—¶ï¼Œå¯ä»¥ä»å‘½ä»¤è¡Œä¼ å€¼ç»™ C ç¨‹åº. è¿™äº›å€¼è¢«ç§°ä¸º**å‘½ä»¤è¡Œå‚æ•°**

* å‘½ä»¤è¡Œå‚æ•°æ˜¯ä½¿ç”¨main()å‡½æ•°å‚æ•°æ¥å¤„ç†çš„ï¼Œå…¶ä¸­ï¼Œ**argc**æ˜¯æŒ‡ä¼ å…¥å‚æ•°çš„ä¸ªæ•°ï¼Œ**argv[]**æ˜¯ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼ŒæŒ‡å‘ä¼ é€’ç»™ç¨‹åºçš„æ¯ä¸ªå‚æ•°ã€‚
* argv[0] å­˜å‚¨ç¨‹åºçš„åç§°ï¼Œargv[1] æ˜¯ä¸€ä¸ªæŒ‡å‘ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°çš„æŒ‡é’ˆï¼Œ*argv[n] æ˜¯æœ€åä¸€ä¸ªå‚æ•°

ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å®ä¾‹ï¼Œæ£€æŸ¥å‘½ä»¤è¡Œæ˜¯å¦æœ‰æä¾›å‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œ

```c
#include <stdio.h>

int main( int argc, char *argv[] )  
{
   if( argc == 2 )
   {
      printf("The argument supplied is %s\n", argv[1]);
   }
   else if( argc > 2 )
   {
      printf("Too many arguments supplied.\n");
   }
   else
   {
      printf("One argument expected.\n");
   }
}

$./a.out testing
The argument supplied is testing
```